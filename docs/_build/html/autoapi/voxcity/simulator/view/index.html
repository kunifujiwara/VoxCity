<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Use cases of VoxCity" href="../../../../examples/index.html" /><link rel="prev" title="voxcity.simulator.solar" href="../solar/index.html" />

    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>voxcity.simulator.view - VoxCity Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=7edd21af" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">VoxCity Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">VoxCity Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../example.html"><strong>VoxCity Demo</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example.html#step1-prepare-environment">Step1. Prepare environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example.html#step2-set-target-area-by-a-rectangle">Step2. Set target area by a rectangle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example.html#step3-set-variables">Step3 Set variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example.html#step4-get-voxcity-output">Step4 Get voxcity output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example.html#step5-export-files">Step5 Export files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example.html#step6-urban-simulations">Step6 Urban simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example.html#solar-radiation">6.1. Solar radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example.html#landmark-visibility">6.3. Landmark visibility</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../index.html">voxcity</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of voxcity</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../downloader/index.html">voxcity.downloader</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of voxcity.downloader</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../downloader/citygml/index.html">voxcity.downloader.citygml</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../downloader/eubucco/index.html">voxcity.downloader.eubucco</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../downloader/gee/index.html">voxcity.downloader.gee</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../downloader/mbfp/index.html">voxcity.downloader.mbfp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../downloader/oemj/index.html">voxcity.downloader.oemj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../downloader/osm/index.html">voxcity.downloader.osm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../downloader/overture/index.html">voxcity.downloader.overture</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../exporter/index.html">voxcity.exporter</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of voxcity.exporter</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../exporter/envimet/index.html">voxcity.exporter.envimet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exporter/magicavoxel/index.html">voxcity.exporter.magicavoxel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exporter/obj/index.html">voxcity.exporter.obj</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../generator/index.html">voxcity.generator</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../geoprocessor/index.html">voxcity.geoprocessor</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of voxcity.geoprocessor</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../geoprocessor/draw/index.html">voxcity.geoprocessor.draw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../geoprocessor/grid/index.html">voxcity.geoprocessor.grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../geoprocessor/mesh/index.html">voxcity.geoprocessor.mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../geoprocessor/network/index.html">voxcity.geoprocessor.network</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../geoprocessor/polygon/index.html">voxcity.geoprocessor.polygon</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="../index.html">voxcity.simulator</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of voxcity.simulator</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../solar/index.html">voxcity.simulator.solar</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">voxcity.simulator.view</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../examples/index.html">Use cases of VoxCity</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Use cases of VoxCity</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/demo_basic.html"><strong>VoxCity Demo</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/demo_basic.html#step1-prepare-environment">Step1. Prepare environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/demo_basic.html#step2-set-target-area-by-a-rectangle">Step2. Set target area by a rectangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/demo_basic.html#step3-set-variables">Step3 Set variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/demo_basic.html#step4-get-voxcity-output">Step4 Get voxcity output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/demo_basic.html#step5-export-files">Step5 Export files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/demo_basic.html#step6-urban-simulations">Step6 Urban simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/demo_basic.html#solar-radiation">6.1. Solar radiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/demo_basic.html#landmark-visibility">6.3. Landmark visibility</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../changelog.html">=======
History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing.html">============
Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../conduct.html">====================================
Contributor Covenant Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../references.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../../_sources/autoapi/voxcity/simulator/view/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-voxcity.simulator.view">
<span id="voxcity-simulator-view"></span><h1>voxcity.simulator.view<a class="headerlink" href="#module-voxcity.simulator.view" title="Link to this heading">¶</a></h1>
<p>Functions for computing and visualizing various view indices in a voxel city model.</p>
<p>This module provides functionality to compute and visualize:
- Green View Index (GVI): Measures visibility of green elements like trees and vegetation
- Sky View Index (SVI): Measures visibility of open sky from street level
- Sky View Factor (SVF): Measures the ratio of visible sky hemisphere to total hemisphere
- Landmark Visibility: Measures visibility of specified landmark buildings from different locations</p>
<p>The module uses optimized ray tracing techniques with Numba JIT compilation for efficient computation.
Key features:
- Generic ray tracing framework that can be customized for different view indices
- Parallel processing for fast computation of view maps
- Tree transmittance modeling using Beer-Lambert law
- Visualization tools including matplotlib plots and OBJ exports
- Support for both inclusion and exclusion based visibility checks</p>
<p>The module provides several key functions:
- trace_ray_generic(): Core ray tracing function that handles tree transmittance
- compute_vi_generic(): Computes view indices by casting rays in specified directions
- compute_vi_map_generic(): Generates 2D maps of view indices
- get_view_index(): High-level function to compute various view indices
- compute_landmark_visibility(): Computes visibility of landmark buildings
- get_sky_view_factor_map(): Computes sky view factor maps</p>
<p>The module uses a voxel-based representation where:
- Empty space is represented by 0
- Trees are represented by -2
- Buildings are represented by -3
- Other values can be used for different features</p>
<p>Tree transmittance is modeled using the Beer-Lambert law with configurable parameters:
- tree_k: Static extinction coefficient (default 0.6)
- tree_lad: Leaf area density in m^-1 (default 1.0)</p>
<p>Additional implementation details:
- Uses DDA (Digital Differential Analyzer) algorithm for efficient ray traversal
- Handles edge cases like zero-length rays and division by zero
- Supports early exit optimizations for performance
- Provides flexible observer placement rules
- Includes comprehensive error checking and validation
- Allows customization of visualization parameters</p>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#voxcity.simulator.view.calculate_transmittance" title="voxcity.simulator.view.calculate_transmittance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_transmittance</span></code></a>(length[, tree_k, tree_lad])</p></td>
<td><p>Calculate tree transmittance using the Beer-Lambert law.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#voxcity.simulator.view.trace_ray_generic" title="voxcity.simulator.view.trace_ray_generic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trace_ray_generic</span></code></a>(voxel_data, origin, direction, ...)</p></td>
<td><p>Trace a ray through a voxel grid and check for hits with specified values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#voxcity.simulator.view.compute_vi_generic" title="voxcity.simulator.view.compute_vi_generic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_vi_generic</span></code></a>(observer_location, voxel_data, ...)</p></td>
<td><p>Compute view index accounting for tree transmittance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#voxcity.simulator.view.compute_vi_map_generic" title="voxcity.simulator.view.compute_vi_map_generic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_vi_map_generic</span></code></a>(voxel_data, ray_directions, ...)</p></td>
<td><p>Compute view index map incorporating tree transmittance.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#voxcity.simulator.view.get_view_index" title="voxcity.simulator.view.get_view_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_view_index</span></code></a>(voxel_data, meshsize[, mode, ...])</p></td>
<td><p>Calculate and visualize a generic view index for a voxel city model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#voxcity.simulator.view.mark_building_by_id" title="voxcity.simulator.view.mark_building_by_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mark_building_by_id</span></code></a>(voxcity_grid_ori, ...)</p></td>
<td><p>Mark specific buildings in the voxel grid with a given value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#voxcity.simulator.view.trace_ray_to_target" title="voxcity.simulator.view.trace_ray_to_target"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trace_ray_to_target</span></code></a>(voxel_data, origin, target, ...)</p></td>
<td><p>Trace a ray from origin to target through voxel data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#voxcity.simulator.view.compute_visibility_to_all_landmarks" title="voxcity.simulator.view.compute_visibility_to_all_landmarks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_visibility_to_all_landmarks</span></code></a>(observer_location, ...)</p></td>
<td><p>Check if any landmark is visible from the observer location.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#voxcity.simulator.view.compute_visibility_map" title="voxcity.simulator.view.compute_visibility_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_visibility_map</span></code></a>(voxel_data, landmark_positions, ...)</p></td>
<td><p>Compute visibility map for landmarks in the voxel grid.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#voxcity.simulator.view.compute_landmark_visibility" title="voxcity.simulator.view.compute_landmark_visibility"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_landmark_visibility</span></code></a>(voxel_data[, ...])</p></td>
<td><p>Compute and visualize landmark visibility in a voxel grid.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#voxcity.simulator.view.get_landmark_visibility_map" title="voxcity.simulator.view.get_landmark_visibility_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_landmark_visibility_map</span></code></a>(voxcity_grid_ori, ...)</p></td>
<td><p>Generate a visibility map for landmark buildings in a voxel city.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#voxcity.simulator.view.get_sky_view_factor_map" title="voxcity.simulator.view.get_sky_view_factor_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sky_view_factor_map</span></code></a>(voxel_data, meshsize[, show_plot])</p></td>
<td><p>Compute and visualize the Sky View Factor (SVF) for each valid observer cell in the voxel grid.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#voxcity.simulator.view.rotate_vector_axis_angle" title="voxcity.simulator.view.rotate_vector_axis_angle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotate_vector_axis_angle</span></code></a>(vec, axis, angle)</p></td>
<td><p>Rotate a 3D vector around an arbitrary axis using Rodrigues' rotation formula.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#voxcity.simulator.view.compute_view_factor_for_all_faces" title="voxcity.simulator.view.compute_view_factor_for_all_faces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_view_factor_for_all_faces</span></code></a>(face_centers, ...[, ...])</p></td>
<td><p>Compute a per-face &quot;view factor&quot; for a specified set of target voxel classes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#voxcity.simulator.view.get_surface_view_factor" title="voxcity.simulator.view.get_surface_view_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_surface_view_factor</span></code></a>(voxel_data, meshsize, **kwargs)</p></td>
<td><p>Compute and optionally visualize view factors for surface meshes with respect to target voxel classes.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.calculate_transmittance">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">calculate_transmittance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_lad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#calculate_transmittance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.calculate_transmittance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate tree transmittance using the Beer-Lambert law.</p>
<p>Uses the Beer-Lambert law to model light attenuation through tree canopy:
transmittance = exp(-k * LAD * L)
where:
- k is the extinction coefficient
- LAD is the leaf area density
- L is the path length through the canopy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<em>float</em>) – Path length through tree voxel in meters</p></li>
<li><p><strong>tree_k</strong> (<em>float</em>) – Static extinction coefficient (default: 0.6)
Controls overall light attenuation strength</p></li>
<li><p><strong>tree_lad</strong> (<em>float</em>) – Leaf area density in m^-1 (default: 1.0)
Higher values = denser foliage = more attenuation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Transmittance value between 0 and 1</dt><dd><p>1.0 = fully transparent
0.0 = fully opaque</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.trace_ray_generic">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">trace_ray_generic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hit_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_lad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusion_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#trace_ray_generic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.trace_ray_generic" title="Link to this definition">¶</a></dt>
<dd><p>Trace a ray through a voxel grid and check for hits with specified values.</p>
<p>Uses DDA algorithm to efficiently traverse voxels along ray path.
Handles tree transmittance using Beer-Lambert law.</p>
<p>The DDA algorithm:
1. Initializes ray at origin voxel
2. Calculates distances to next voxel boundaries in each direction
3. Steps to next voxel by choosing smallest distance
4. Repeats until hit or out of bounds</p>
<p>Tree transmittance:
- When ray passes through tree voxels (-2), transmittance is accumulated
- Uses Beer-Lambert law with configurable extinction coefficient and leaf area density
- Ray is considered blocked if cumulative transmittance falls below 0.01</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values</p></li>
<li><p><strong>origin</strong> (<em>ndarray</em>) – Starting point (x,y,z) of ray in voxel coordinates</p></li>
<li><p><strong>direction</strong> (<em>ndarray</em>) – Direction vector of ray (will be normalized)</p></li>
<li><p><strong>hit_values</strong> (<em>tuple</em>) – Values to check for hits</p></li>
<li><p><strong>meshsize</strong> (<em>float</em>) – Size of each voxel in meters</p></li>
<li><p><strong>tree_k</strong> (<em>float</em>) – Tree extinction coefficient</p></li>
<li><p><strong>tree_lad</strong> (<em>float</em>) – Leaf area density in m^-1</p></li>
<li><p><strong>inclusion_mode</strong> (<em>bool</em>) – If True, hit_values are hits. If False, hit_values are allowed values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(hit_detected, transmittance_value)</dt><dd><p>hit_detected (bool): Whether ray hit a target voxel
transmittance_value (float): Cumulative transmittance through trees</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.compute_vi_generic">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">compute_vi_generic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observer_location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hit_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_lad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusion_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#compute_vi_generic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.compute_vi_generic" title="Link to this definition">¶</a></dt>
<dd><p>Compute view index accounting for tree transmittance.</p>
<p>Casts rays in specified directions and computes visibility index based on hits and transmittance.
The view index is the ratio of visible rays to total rays cast, where:
- For inclusion mode: Counts hits with target values
- For exclusion mode: Counts rays that don’t hit obstacles
Tree transmittance is handled specially:
- In inclusion mode with trees as targets: Uses (1 - transmittance) as contribution
- In exclusion mode: Uses transmittance value directly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observer_location</strong> (<em>ndarray</em>) – Observer position (x,y,z) in voxel coordinates</p></li>
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values</p></li>
<li><p><strong>ray_directions</strong> (<em>ndarray</em>) – Array of direction vectors for rays</p></li>
<li><p><strong>hit_values</strong> (<em>tuple</em>) – Values to check for hits</p></li>
<li><p><strong>meshsize</strong> (<em>float</em>) – Size of each voxel in meters</p></li>
<li><p><strong>tree_k</strong> (<em>float</em>) – Tree extinction coefficient</p></li>
<li><p><strong>tree_lad</strong> (<em>float</em>) – Leaf area density in m^-1</p></li>
<li><p><strong>inclusion_mode</strong> (<em>bool</em>) – If True, hit_values are hits. If False, hit_values are allowed values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>View index value between 0 and 1</dt><dd><p>0.0 = no visibility in any direction
1.0 = full visibility in all directions</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.compute_vi_map_generic">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">compute_vi_map_generic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view_height_voxel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hit_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_lad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusion_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#compute_vi_map_generic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.compute_vi_map_generic" title="Link to this definition">¶</a></dt>
<dd><p>Compute view index map incorporating tree transmittance.</p>
<p>Places observers at valid locations and computes view index for each position.
Valid observer locations are:
- Empty voxels (0) or tree voxels (-2)
- Above non-empty, non-tree voxels
- Not above water (7,8,9) or negative values</p>
<p>The function processes each x,y position in parallel for efficiency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values</p></li>
<li><p><strong>ray_directions</strong> (<em>ndarray</em>) – Array of direction vectors for rays</p></li>
<li><p><strong>view_height_voxel</strong> (<em>int</em>) – Observer height in voxel units</p></li>
<li><p><strong>hit_values</strong> (<em>tuple</em>) – Values to check for hits</p></li>
<li><p><strong>meshsize</strong> (<em>float</em>) – Size of each voxel in meters</p></li>
<li><p><strong>tree_k</strong> (<em>float</em>) – Tree extinction coefficient</p></li>
<li><p><strong>tree_lad</strong> (<em>float</em>) – Leaf area density in m^-1</p></li>
<li><p><strong>inclusion_mode</strong> (<em>bool</em>) – If True, hit_values are hits. If False, hit_values are allowed values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>2D array of view index values</dt><dd><p>NaN = invalid observer location
0.0-1.0 = view index value</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.get_view_index">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">get_view_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hit_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusion_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#get_view_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.get_view_index" title="Link to this definition">¶</a></dt>
<dd><p>Calculate and visualize a generic view index for a voxel city model.</p>
<p>This is a high-level function that provides a flexible interface for computing
various view indices. It handles:
- Mode presets for common indices (green, sky)
- Ray direction generation
- Tree transmittance parameters
- Visualization
- Optional OBJ export</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values.</p></li>
<li><p><strong>meshsize</strong> (<em>float</em>) – Size of each voxel in meters.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – Predefined mode. Options: ‘green’, ‘sky’, or None.
If ‘green’: GVI mode - measures visibility of vegetation
If ‘sky’: SVI mode - measures visibility of open sky
If None: Custom mode requiring hit_values parameter</p></li>
<li><p><strong>hit_values</strong> (<em>tuple</em>) – Voxel values considered as hits (if inclusion_mode=True)
or allowed values (if inclusion_mode=False), if mode is None.</p></li>
<li><p><strong>inclusion_mode</strong> (<em>bool</em>) – True = voxel_value in hit_values is success.
False = voxel_value not in hit_values is success.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments:
- view_point_height (float): Observer height in meters (default: 1.5)
- colormap (str): Matplotlib colormap name (default: ‘viridis’)
- obj_export (bool): Export as OBJ (default: False)
- output_directory (str): Directory for OBJ output
- output_file_name (str): Base filename for OBJ output
- num_colors (int): Number of discrete colors for OBJ export
- alpha (float): Transparency value for OBJ export
- vmin (float): Minimum value for color mapping
- vmax (float): Maximum value for color mapping
- N_azimuth (int): Number of azimuth angles for ray directions
- N_elevation (int): Number of elevation angles for ray directions
- elevation_min_degrees (float): Minimum elevation angle in degrees
- elevation_max_degrees (float): Maximum elevation angle in degrees
- tree_k (float): Tree extinction coefficient (default: 0.5)
- tree_lad (float): Leaf area density in m^-1 (default: 1.0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D array of computed view index values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.mark_building_by_id">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">mark_building_by_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxcity_grid_ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">building_id_grid_ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mark</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#mark_building_by_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.mark_building_by_id" title="Link to this definition">¶</a></dt>
<dd><p>Mark specific buildings in the voxel grid with a given value.</p>
<p>This function is used to identify landmark buildings for visibility analysis
by replacing their voxel values with a special marker value. It handles
coordinate system alignment between the building ID grid and voxel grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxcity_grid_ori</strong> (<em>ndarray</em>) – 3D array of voxel values (original, will be copied)</p></li>
<li><p><strong>building_id_grid_ori</strong> (<em>ndarray</em>) – 2D array of building IDs (original, will be copied)</p></li>
<li><p><strong>ids</strong> (<em>list</em>) – List of building IDs to mark as landmarks</p></li>
<li><p><strong>mark</strong> (<em>int</em>) – Value to mark the landmark buildings with (typically negative)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Modified 3D voxel grid with landmark buildings marked</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.trace_ray_to_target">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">trace_ray_to_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opaque_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#trace_ray_to_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.trace_ray_to_target" title="Link to this definition">¶</a></dt>
<dd><p>Trace a ray from origin to target through voxel data.</p>
<p>Uses DDA algorithm to efficiently traverse voxels along ray path.
Checks for any opaque voxels blocking the line of sight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values</p></li>
<li><p><strong>origin</strong> (<em>tuple</em>) – Starting point (x,y,z) in voxel coordinates</p></li>
<li><p><strong>target</strong> (<em>tuple</em>) – End point (x,y,z) in voxel coordinates</p></li>
<li><p><strong>opaque_values</strong> (<em>ndarray</em>) – Array of voxel values that block the ray</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if target is visible from origin, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.compute_visibility_to_all_landmarks">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">compute_visibility_to_all_landmarks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observer_location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landmark_positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opaque_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#compute_visibility_to_all_landmarks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.compute_visibility_to_all_landmarks" title="Link to this definition">¶</a></dt>
<dd><p>Check if any landmark is visible from the observer location.</p>
<p>Traces rays to each landmark position until finding one that’s visible.
Uses optimized ray tracing with early exit on first visible landmark.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observer_location</strong> (<em>ndarray</em>) – Observer position (x,y,z) in voxel coordinates</p></li>
<li><p><strong>landmark_positions</strong> (<em>ndarray</em>) – Array of landmark positions (n_landmarks, 3)</p></li>
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values</p></li>
<li><p><strong>opaque_values</strong> (<em>ndarray</em>) – Array of voxel values that block visibility</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if any landmark is visible, 0 if none are visible</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.compute_visibility_map">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">compute_visibility_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landmark_positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opaque_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view_height_voxel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#compute_visibility_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.compute_visibility_map" title="Link to this definition">¶</a></dt>
<dd><p>Compute visibility map for landmarks in the voxel grid.</p>
<p>Places observers at valid locations (empty voxels above ground, excluding building
roofs and vegetation) and checks visibility to any landmark.</p>
<p>The function processes each x,y position in parallel for efficiency.
Valid observer locations are:
- Empty voxels (0) or tree voxels (-2)
- Above non-empty, non-tree voxels
- Not above water (7,8,9) or negative values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values</p></li>
<li><p><strong>landmark_positions</strong> (<em>ndarray</em>) – Array of landmark positions (n_landmarks, 3)</p></li>
<li><p><strong>opaque_values</strong> (<em>ndarray</em>) – Array of voxel values that block visibility</p></li>
<li><p><strong>view_height_voxel</strong> (<em>int</em>) – Height offset for observer in voxels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>2D array of visibility values</dt><dd><p>NaN = invalid observer location
0 = no landmarks visible
1 = at least one landmark visible</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.compute_landmark_visibility">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">compute_landmark_visibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view_height_voxel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#compute_landmark_visibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.compute_landmark_visibility" title="Link to this definition">¶</a></dt>
<dd><p>Compute and visualize landmark visibility in a voxel grid.</p>
<p>Places observers at valid locations and checks visibility to any landmark voxel.
Generates a binary visibility map and visualization.</p>
<p>The function:
1. Identifies all landmark voxels (target_value)
2. Determines which voxel values block visibility
3. Computes visibility from each valid observer location
4. Generates visualization with legend</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values</p></li>
<li><p><strong>target_value</strong> (<em>int</em><em>, </em><em>optional</em>) – Value used to identify landmark voxels. Defaults to -30.</p></li>
<li><p><strong>view_height_voxel</strong> (<em>int</em><em>, </em><em>optional</em>) – Height offset for observer in voxels. Defaults to 0.</p></li>
<li><p><strong>colormap</strong> (<em>str</em><em>, </em><em>optional</em>) – Matplotlib colormap name. Defaults to ‘viridis’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>2D array of visibility values (0 or 1) with y-axis flipped</dt><dd><p>NaN = invalid observer location
0 = no landmarks visible
1 = at least one landmark visible</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no landmark voxels are found with the specified target_value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.get_landmark_visibility_map">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">get_landmark_visibility_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxcity_grid_ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">building_id_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">building_gdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshsize</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#get_landmark_visibility_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.get_landmark_visibility_map" title="Link to this definition">¶</a></dt>
<dd><p>Generate a visibility map for landmark buildings in a voxel city.</p>
<p>Places observers at valid locations and checks visibility to any part of the
specified landmark buildings. Can identify landmarks either by ID or by finding
buildings within a specified rectangle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxcity_grid</strong> (<em>ndarray</em>) – 3D array representing the voxel city</p></li>
<li><p><strong>building_id_grid</strong> (<em>ndarray</em>) – 3D array mapping voxels to building IDs</p></li>
<li><p><strong>building_gdf</strong> (<em>GeoDataFrame</em>) – GeoDataFrame containing building features</p></li>
<li><p><strong>meshsize</strong> (<em>float</em>) – Size of each voxel in meters</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments
view_point_height (float): Height of observer viewpoint in meters
colormap (str): Matplotlib colormap name
landmark_building_ids (list): List of building IDs to mark as landmarks
rectangle_vertices (list): List of (lat,lon) coordinates defining rectangle
obj_export (bool): Whether to export visibility map as OBJ file
dem_grid (ndarray): Digital elevation model grid for OBJ export
output_directory (str): Directory for OBJ file output
output_file_name (str): Base filename for OBJ output
alpha (float): Alpha transparency value for OBJ export
vmin (float): Minimum value for color mapping
vmax (float): Maximum value for color mapping</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D array of visibility values for landmark buildings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.get_sky_view_factor_map">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">get_sky_view_factor_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#get_sky_view_factor_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.get_sky_view_factor_map" title="Link to this definition">¶</a></dt>
<dd><p>Compute and visualize the Sky View Factor (SVF) for each valid observer cell in the voxel grid.</p>
<p>Sky View Factor measures the proportion of the sky hemisphere that is visible from a given point.
It ranges from 0 (completely obstructed) to 1 (completely open sky). This implementation:
- Uses hemisphere ray casting to sample sky visibility
- Accounts for tree transmittance using Beer-Lambert law
- Places observers at valid street-level locations
- Provides optional visualization and OBJ export</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values.</p></li>
<li><p><strong>meshsize</strong> (<em>float</em>) – Size of each voxel in meters.</p></li>
<li><p><strong>show_plot</strong> (<em>bool</em>) – Whether to display the SVF visualization plot.</p></li>
<li><p><strong>**kwargs</strong> – Additional parameters including:
view_point_height (float): Observer height in meters (default: 1.5)
colormap (str): Matplotlib colormap name (default: ‘BuPu_r’)
vmin, vmax (float): Color scale limits (default: 0.0, 1.0)
N_azimuth (int): Number of azimuth angles for ray sampling (default: 60)
N_elevation (int): Number of elevation angles for ray sampling (default: 10)
elevation_min_degrees (float): Minimum elevation angle (default: 0)
elevation_max_degrees (float): Maximum elevation angle (default: 90)
tree_k (float): Tree extinction coefficient (default: 0.6)
tree_lad (float): Leaf area density in m^-1 (default: 1.0)
obj_export (bool): Whether to export as OBJ file (default: False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>2D array of SVF values at each valid observer location (x, y).</dt><dd><p>NaN values indicate invalid observer positions.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.rotate_vector_axis_angle">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">rotate_vector_axis_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#rotate_vector_axis_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.rotate_vector_axis_angle" title="Link to this definition">¶</a></dt>
<dd><p>Rotate a 3D vector around an arbitrary axis using Rodrigues’ rotation formula.</p>
<p>This function implements the Rodrigues rotation formula:
v_rot = v*cos(θ) + (k × v)*sin(θ) + k*(k·v)*(1-cos(θ))
where k is the unit rotation axis, θ is the rotation angle, and v is the input vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vec</strong> (<em>ndarray</em>) – 3D vector to rotate [x, y, z]</p></li>
<li><p><strong>axis</strong> (<em>ndarray</em>) – 3D rotation axis vector [x, y, z] (will be normalized)</p></li>
<li><p><strong>angle</strong> (<em>float</em>) – Rotation angle in radians</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rotated 3D vector [x, y, z]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.compute_view_factor_for_all_faces">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">compute_view_factor_for_all_faces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">face_centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face_normals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere_dirs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_lad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusion_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bounds_real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_downward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#compute_view_factor_for_all_faces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.compute_view_factor_for_all_faces" title="Link to this definition">¶</a></dt>
<dd><p>Compute a per-face “view factor” for a specified set of target voxel classes.</p>
<p>This function computes view factors from building surface faces to target voxel types
(e.g., sky, trees, other buildings). It uses hemisphere ray casting with rotation
to align rays with each face’s normal direction.</p>
<p>Typical usage examples:
- Sky View Factor: target_values=(0,), inclusion_mode=False (sky voxels)
- Tree View Factor: target_values=(-2,), inclusion_mode=True (tree voxels)
- Building View Factor: target_values=(-3,), inclusion_mode=True (building voxels)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>face_centers</strong> (<em>np.ndarray</em>) – (n_faces, 3) face centroid positions in real coordinates.</p></li>
<li><p><strong>face_normals</strong> (<em>np.ndarray</em>) – (n_faces, 3) face normal vectors (outward pointing).</p></li>
<li><p><strong>hemisphere_dirs</strong> (<em>np.ndarray</em>) – (N, 3) set of direction vectors in the upper hemisphere.</p></li>
<li><p><strong>voxel_data</strong> (<em>np.ndarray</em>) – 3D array of voxel values.</p></li>
<li><p><strong>meshsize</strong> (<em>float</em>) – Size of each voxel in meters.</p></li>
<li><p><strong>tree_k</strong> (<em>float</em>) – Tree extinction coefficient for Beer-Lambert law.</p></li>
<li><p><strong>tree_lad</strong> (<em>float</em>) – Leaf area density in m^-1 for tree transmittance.</p></li>
<li><p><strong>target_values</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Voxel classes that define a ‘hit’ or target.</p></li>
<li><p><strong>inclusion_mode</strong> (<em>bool</em>) – If True, hitting target_values counts as visibility.
If False, hitting anything NOT in target_values blocks the ray.</p></li>
<li><p><strong>grid_bounds_real</strong> (<em>np.ndarray</em>) – [[x_min,y_min,z_min],[x_max,y_max,z_max]] in real coords.</p></li>
<li><p><strong>boundary_epsilon</strong> (<em>float</em>) – Tolerance for identifying boundary vertical faces.</p></li>
<li><p><strong>ignore_downward</strong> (<em>bool</em>) – If True, only consider upward rays. If False, consider all outward rays.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Computed view factor for each face.</dt><dd><p>NaN values indicate boundary vertical faces that should be excluded.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (n_faces,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voxcity.simulator.view.get_surface_view_factor">
<span class="sig-prename descclassname"><span class="pre">voxcity.simulator.view.</span></span><span class="sig-name descname"><span class="pre">get_surface_view_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshsize</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/voxcity/simulator/view.html#get_surface_view_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voxcity.simulator.view.get_surface_view_factor" title="Link to this definition">¶</a></dt>
<dd><p>Compute and optionally visualize view factors for surface meshes with respect to target voxel classes.</p>
<p>This function provides a flexible framework for computing various surface-based view factors:
- Sky View Factor: Fraction of sky hemisphere visible from building surfaces
- Tree View Factor: Fraction of directions that intersect vegetation
- Building View Factor: Fraction of directions that intersect other buildings
- Custom View Factors: User-defined target voxel classes</p>
<p>The function extracts surface meshes from the voxel data, then computes view factors
for each face using hemisphere ray casting with proper geometric transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_data</strong> (<em>ndarray</em>) – 3D array of voxel values representing the urban environment.</p></li>
<li><p><strong>meshsize</strong> (<em>float</em>) – Size of each voxel in meters for coordinate scaling.</p></li>
<li><p><strong>**kwargs</strong> – <p>Extensive configuration options including:
# Target specification:
target_values (tuple[int]): Voxel classes to measure visibility to (default: (0,) for sky)
inclusion_mode (bool): Interpretation of target_values (default: False for sky)</p>
<p># Surface extraction:
building_class_id (int): Voxel class to extract surfaces from (default: -3 for buildings)
building_id_grid (ndarray): Optional grid mapping voxels to building IDs</p>
<p># Ray sampling:
N_azimuth (int): Number of azimuth angles for hemisphere sampling (default: 60)
N_elevation (int): Number of elevation angles for hemisphere sampling (default: 10)</p>
<p># Tree transmittance (Beer-Lambert law):
tree_k (float): Tree extinction coefficient (default: 0.6)
tree_lad (float): Leaf area density in m^-1 (default: 1.0)</p>
<p># Visualization and export:
colormap (str): Matplotlib colormap for visualization (default: ‘BuPu_r’)
vmin, vmax (float): Color scale limits (default: 0.0, 1.0)
obj_export (bool): Whether to export mesh as OBJ file (default: False)
output_directory (str): Directory for OBJ export (default: “output”)
output_file_name (str): Base filename for OBJ export (default: “surface_view_factor”)</p>
<p># Other options:
progress_report (bool): Whether to print computation progress (default: False)
debug (bool): Enable debug output (default: False)</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Surface mesh with per-face view factor values stored in metadata.</dt><dd><p>The view factor values can be accessed via mesh.metadata[value_name].
Returns None if no surfaces are found or extraction fails.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh.Trimesh</p>
</dd>
</dl>
<dl>
<dt>Example Usage:</dt><dd><p># Sky View Factor for building surfaces
mesh = get_surface_view_factor(voxel_data, meshsize,</p>
<blockquote>
<div><p>target_values=(0,), inclusion_mode=False)</p>
</div></blockquote>
<p># Tree View Factor for building surfaces
mesh = get_surface_view_factor(voxel_data, meshsize,</p>
<blockquote>
<div><p>target_values=(-2,), inclusion_mode=True)</p>
</div></blockquote>
<p># Custom view factor with OBJ export
mesh = get_surface_view_factor(voxel_data, meshsize,</p>
<blockquote>
<div><p>target_values=(-3,), inclusion_mode=True,
obj_export=True, output_file_name=”building_view_factor”)</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../../../examples/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Use cases of VoxCity</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../solar/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">voxcity.simulator.solar</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Kunihiko Fujiwara
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">voxcity.simulator.view</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#module-contents">Module Contents</a><ul>
<li><a class="reference internal" href="#voxcity.simulator.view.calculate_transmittance"><code class="docutils literal notranslate"><span class="pre">calculate_transmittance()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.trace_ray_generic"><code class="docutils literal notranslate"><span class="pre">trace_ray_generic()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.compute_vi_generic"><code class="docutils literal notranslate"><span class="pre">compute_vi_generic()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.compute_vi_map_generic"><code class="docutils literal notranslate"><span class="pre">compute_vi_map_generic()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.get_view_index"><code class="docutils literal notranslate"><span class="pre">get_view_index()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.mark_building_by_id"><code class="docutils literal notranslate"><span class="pre">mark_building_by_id()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.trace_ray_to_target"><code class="docutils literal notranslate"><span class="pre">trace_ray_to_target()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.compute_visibility_to_all_landmarks"><code class="docutils literal notranslate"><span class="pre">compute_visibility_to_all_landmarks()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.compute_visibility_map"><code class="docutils literal notranslate"><span class="pre">compute_visibility_map()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.compute_landmark_visibility"><code class="docutils literal notranslate"><span class="pre">compute_landmark_visibility()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.get_landmark_visibility_map"><code class="docutils literal notranslate"><span class="pre">get_landmark_visibility_map()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.get_sky_view_factor_map"><code class="docutils literal notranslate"><span class="pre">get_sky_view_factor_map()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.rotate_vector_axis_angle"><code class="docutils literal notranslate"><span class="pre">rotate_vector_axis_angle()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.compute_view_factor_for_all_faces"><code class="docutils literal notranslate"><span class="pre">compute_view_factor_for_all_faces()</span></code></a></li>
<li><a class="reference internal" href="#voxcity.simulator.view.get_surface_view_factor"><code class="docutils literal notranslate"><span class="pre">get_surface_view_factor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>